library(tidyverse)
library(brms)
library(tidybayes)
library(modelr)
# data were retrieved from https://figshare.com/articles/dataset/Barton_et_al_2020_EcoLetters_Data_code_zip/11594595?file=20976921
GP_H_rate<-read.csv("Barton_et_al_2020_EcoLetters_Data_code/Metabolism schoolfield nlme/gross_photosynthesis_data_for_nlme.csv")
R_H_rate<-read.csv("Barton_et_al_2020_EcoLetters_Data_code/Metabolism schoolfield nlme/respiration_data_for_nlme.csv")

gp_r = full_join(GP_H_rate %>% rename(rateGP = rate.c.cell.c.h, lnGP = ln.rate),
                 R_H_rate %>% rename(rateR = rate.c.cell.c.h, lnR = ln.rate)) %>%
  arrange(ID)


inits = list(
  b_lnGP_lnc = -3,
  b_lnGP_Ea = .7,
  b_lnGP_Eh = 5,
  b_lnGP_Th = 303,

  b_lnR_lnc = -4,
  b_lnR_Ea = .7,
  b_lnR_Eh = 5,
  b_lnR_Th = 305
)
list_of_inits = list(inits, inits, inits, inits)

m = brm(
  bf(
    lnGP | mi() ~ lnc + (Ea/(8.62 * 10^-5) * (1/293.15 - 1/K)) - log(1 + exp(Eh/(8.62 * 10^-5) * (1/Th - 1/(K)))),
    lnc ~ 1 + (1|p|species) + (1|q|rep)
    ,Ea ~ 1 + (1|p|species) + (1|q|rep)
    ,Eh ~ 1 + (1|p|species) + (1|q|rep)
    ,Th ~ 1 + (1|p|species) + (1|q|rep)
    ,sigma ~ 1 + (1|species)
    ,nl = T
  ) +
    bf(
      lnR | mi() ~ lnc + (Ea/(8.62 * 10^-5) * (1/293.15 - 1/K)) - log(1 + exp(Eh/(8.62 * 10^-5) * (1/Th - 1/(K)))),
      lnc ~ 1 + (1|p|species) + (1|q|rep)
      ,Ea ~ 1 + (1|p|species) + (1|q|rep)
      ,Eh ~ 1 + (1|p|species) + (1|q|rep)
      ,Th ~ 1 + (1|p|species) + (1|q|rep)
      ,sigma ~ 1 + (1|species)
      ,nl = T
    ) + set_rescor(FALSE),
  family = gaussian(),
  prior = prior(normal( -3,  1),resp = "lnGP",  nlpar = "lnc") +
    prior(normal( .7, .5),resp = "lnGP", nlpar = "Ea", lb = 0) +
    prior(normal(  5,  6),resp = "lnGP", nlpar = "Eh", lb = 0) +
    prior(normal(303,  10),resp = "lnGP", nlpar = "Th", lb = 273.15) +

    prior(normal(-4,   1),resp = "lnR",  nlpar = "lnc") +
    prior(normal( .7, .5),resp = "lnR", nlpar = "Ea", lb = 0) +
    prior(normal(  5,  6),resp = "lnR", nlpar = "Eh", lb = 0) +
    prior(normal(305,  10),resp = "lnR", nlpar = "Th", lb = 273.15),
  backend = "cmdstanr",
  init = list_of_inits,
  chains = 4,
  iter = 16000,
  warmup = 4000,
  thin = 1,
  control = list(adapt_delta = .99),
  cores = 4,
  seed = 321,
  data = gp_r
  ,file = "both_log_corr_reps_all"
)

summary(m)
# Multilevel Hyperparameters:
#   ~species (Number of levels: 18)
#                                           Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
# sd(sigma_lnGP_Intercept)                      0.27      0.08     0.14     0.45 1.00     7331    11542
# sd(lnGP_lnc_Intercept)                        0.97      0.16     0.71     1.34 1.00     5798    11763
# sd(lnGP_Ea_Intercept)                         0.08      0.04     0.02     0.16 1.00     4532     5349
# sd(lnGP_Eh_Intercept)                         2.10      0.60     1.02     3.40 1.00     5924     5208
# sd(lnGP_Th_Intercept)                         3.82      0.67     2.76     5.33 1.00    12709    20490
# sd(lnR_lnc_Intercept)                         1.00      0.17     0.72     1.39 1.00     7672    14753
# sd(lnR_Ea_Intercept)                          0.18      0.05     0.09     0.29 1.00     7176     6394
# sd(lnR_Eh_Intercept)                          0.64      0.20     0.25     1.07 1.00     5593     4413
# sd(lnR_Th_Intercept)                          3.29      0.58     2.31     4.61 1.00    12585    21889
# sd(sigma_lnR_Intercept)                       0.30      0.07     0.18     0.46 1.00    11565    21218
# cor(lnGP_lnc_Intercept,lnGP_Ea_Intercept)    -0.15      0.24    -0.59     0.34 1.00    15538    22465
# cor(lnGP_lnc_Intercept,lnGP_Eh_Intercept)     0.19      0.21    -0.23     0.57 1.00    12419    19682
# cor(lnGP_Ea_Intercept,lnGP_Eh_Intercept)      0.17      0.28    -0.40     0.67 1.00     5808    10993
# cor(lnGP_lnc_Intercept,lnGP_Th_Intercept)     0.14      0.18    -0.23     0.48 1.00    12415    20568
# cor(lnGP_Ea_Intercept,lnGP_Th_Intercept)     -0.43      0.23    -0.80     0.07 1.00     5044     7754
# cor(lnGP_Eh_Intercept,lnGP_Th_Intercept)      0.09      0.22    -0.35     0.50 1.00     9045    16020
# cor(lnGP_lnc_Intercept,lnR_lnc_Intercept)     0.80      0.10     0.55     0.93 1.00    10574    17263
# cor(lnGP_Ea_Intercept,lnR_lnc_Intercept)     -0.03      0.24    -0.51     0.44 1.00     9277    16509
# cor(lnGP_Eh_Intercept,lnR_lnc_Intercept)     -0.01      0.22    -0.42     0.41 1.00    11642    19542
# cor(lnGP_Th_Intercept,lnR_lnc_Intercept)     -0.03      0.19    -0.40     0.33 1.00    15576    24338
# cor(lnGP_lnc_Intercept,lnR_Ea_Intercept)      0.10      0.21    -0.32     0.50 1.00    15595    22652
# cor(lnGP_Ea_Intercept,lnR_Ea_Intercept)       0.05      0.28    -0.50     0.59 1.00     5948    12868
# cor(lnGP_Eh_Intercept,lnR_Ea_Intercept)       0.21      0.25    -0.31     0.67 1.00     9263    18192
# cor(lnGP_Th_Intercept,lnR_Ea_Intercept)      -0.11      0.22    -0.53     0.33 1.00    20057    29912
# cor(lnR_lnc_Intercept,lnR_Ea_Intercept)      -0.02      0.22    -0.44     0.40 1.00    17834    27147
# cor(lnGP_lnc_Intercept,lnR_Eh_Intercept)     -0.11      0.22    -0.52     0.33 1.00    14863    21700
# cor(lnGP_Ea_Intercept,lnR_Eh_Intercept)       0.05      0.28    -0.50     0.57 1.00     7940    14488
# cor(lnGP_Eh_Intercept,lnR_Eh_Intercept)       0.29      0.25    -0.25     0.72 1.00    10260    16580
# cor(lnGP_Th_Intercept,lnR_Eh_Intercept)       0.14      0.22    -0.31     0.56 1.00    20268    28947
# cor(lnR_lnc_Intercept,lnR_Eh_Intercept)      -0.18      0.22    -0.58     0.27 1.00    16498    23843
# cor(lnR_Ea_Intercept,lnR_Eh_Intercept)       -0.07      0.26    -0.56     0.45 1.00    13806    24408
# cor(lnGP_lnc_Intercept,lnR_Th_Intercept)      0.04      0.19    -0.33     0.40 1.00    13726    23652
# cor(lnGP_Ea_Intercept,lnR_Th_Intercept)      -0.17      0.25    -0.64     0.33 1.00     5518     9861
# cor(lnGP_Eh_Intercept,lnR_Th_Intercept)      -0.04      0.22    -0.46     0.40 1.00     9799    17635
# cor(lnGP_Th_Intercept,lnR_Th_Intercept)       0.38      0.18    -0.00     0.68 1.00    19868    28146
# cor(lnR_lnc_Intercept,lnR_Th_Intercept)       0.17      0.19    -0.20     0.51 1.00    17163    27359
# cor(lnR_Ea_Intercept,lnR_Th_Intercept)       -0.44      0.20    -0.76     0.01 1.00    14553    21747
# cor(lnR_Eh_Intercept,lnR_Th_Intercept)        0.46      0.21    -0.00     0.79 1.00    15050    20882
#
# ~rep (Number of levels: 55)
#                                           Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
# sd(lnGP_lnc_Intercept)                        0.25      0.03     0.19     0.32 1.00    12015    20547
# sd(lnGP_Ea_Intercept)                         0.09      0.03     0.04     0.14 1.00     4191     4441
# sd(lnGP_Eh_Intercept)                         1.97      0.31     1.45     2.65 1.00     6281    11355
# sd(lnGP_Th_Intercept)                         0.69      0.19     0.36     1.09 1.00     4739     8886
# sd(lnR_lnc_Intercept)                         0.36      0.05     0.28     0.46 1.00    11749    19954
# sd(lnR_Ea_Intercept)                          0.13      0.03     0.09     0.19 1.00     7823    10986
# sd(lnR_Eh_Intercept)                          0.58      0.10     0.40     0.80 1.00     7730    12361
# sd(lnR_Th_Intercept)                          0.50      0.37     0.02     1.38 1.00     5115     9643
# cor(lnGP_lnc_Intercept,lnGP_Ea_Intercept)     0.09      0.21    -0.33     0.50 1.00     9997    19978
# cor(lnGP_lnc_Intercept,lnGP_Eh_Intercept)    -0.05      0.17    -0.37     0.29 1.00     7851    15273
# cor(lnGP_Ea_Intercept,lnGP_Eh_Intercept)     -0.00      0.20    -0.40     0.39 1.00     4278     8173
# cor(lnGP_lnc_Intercept,lnGP_Th_Intercept)     0.21      0.21    -0.21     0.59 1.00    11797    19007
# cor(lnGP_Ea_Intercept,lnGP_Th_Intercept)      0.06      0.29    -0.48     0.63 1.00     5202    11683
# cor(lnGP_Eh_Intercept,lnGP_Th_Intercept)      0.38      0.19    -0.03     0.70 1.00     7895    15211
# cor(lnGP_lnc_Intercept,lnR_lnc_Intercept)     0.53      0.13     0.25     0.74 1.00     9395    18665
# cor(lnGP_Ea_Intercept,lnR_lnc_Intercept)      0.12      0.21    -0.31     0.50 1.00     4631     6849
# cor(lnGP_Eh_Intercept,lnR_lnc_Intercept)      0.18      0.16    -0.15     0.48 1.00    10109    19153
# cor(lnGP_Th_Intercept,lnR_lnc_Intercept)      0.02      0.21    -0.39     0.44 1.00     4560     8211
# cor(lnGP_lnc_Intercept,lnR_Ea_Intercept)     -0.11      0.18    -0.45     0.25 1.00    10812    21051
# cor(lnGP_Ea_Intercept,lnR_Ea_Intercept)       0.48      0.19     0.06     0.80 1.00     5211    12562
# cor(lnGP_Eh_Intercept,lnR_Ea_Intercept)      -0.14      0.18    -0.48     0.23 1.00    10915    19796
# cor(lnGP_Th_Intercept,lnR_Ea_Intercept)       0.16      0.24    -0.32     0.60 1.00     6843    15948
# cor(lnR_lnc_Intercept,lnR_Ea_Intercept)      -0.48      0.15    -0.74    -0.15 1.00    18199    29218
# cor(lnGP_lnc_Intercept,lnR_Eh_Intercept)     -0.51      0.16    -0.77    -0.15 1.00     9162    16752
# cor(lnGP_Ea_Intercept,lnR_Eh_Intercept)       0.15      0.21    -0.28     0.55 1.00     7247    14999
# cor(lnGP_Eh_Intercept,lnR_Eh_Intercept)       0.30      0.18    -0.07     0.62 1.00    10465    21837
# cor(lnGP_Th_Intercept,lnR_Eh_Intercept)       0.12      0.24    -0.37     0.58 1.00     6496    16685
# cor(lnR_lnc_Intercept,lnR_Eh_Intercept)      -0.31      0.17    -0.61     0.04 1.00    14418    26212
# cor(lnR_Ea_Intercept,lnR_Eh_Intercept)        0.20      0.20    -0.21     0.56 1.00    10913    20167
# cor(lnGP_lnc_Intercept,lnR_Th_Intercept)     -0.06      0.31    -0.64     0.56 1.00    21682    27081
# cor(lnGP_Ea_Intercept,lnR_Th_Intercept)       0.00      0.32    -0.62     0.62 1.00    21206    28040
# cor(lnGP_Eh_Intercept,lnR_Th_Intercept)       0.04      0.30    -0.56     0.61 1.00    20465    27481
# cor(lnGP_Th_Intercept,lnR_Th_Intercept)      -0.04      0.33    -0.65     0.60 1.00    18679    26990
# cor(lnR_lnc_Intercept,lnR_Th_Intercept)       0.09      0.32    -0.54     0.67 1.00    22946    29048
# cor(lnR_Ea_Intercept,lnR_Th_Intercept)       -0.25      0.33    -0.79     0.47 1.00    11812    21291
# cor(lnR_Eh_Intercept,lnR_Th_Intercept)        0.14      0.32    -0.52     0.70 1.00    15054    25817
#
# Regression Coefficients:
#                      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
# sigma_lnGP_Intercept    -1.63      0.08    -1.78    -1.46 1.00     8446    14773
# sigma_lnR_Intercept     -1.51      0.08    -1.67    -1.35 1.00     7333    14591
# lnGP_lnc_Intercept      -2.02      0.23    -2.48    -1.58 1.00     2524     4970
# lnGP_Ea_Intercept        0.74      0.03     0.68     0.80 1.00    10757    18421
# lnGP_Eh_Intercept        6.06      0.59     4.90     7.24 1.00     8821    15202
# lnGP_Th_Intercept      306.87      0.93   305.04   308.71 1.00     7487    13029
# lnR_lnc_Intercept       -3.35      0.24    -3.82    -2.89 1.00     3363     7110
# lnR_Ea_Intercept         1.04      0.05     0.94     1.15 1.00    10782    17487
# lnR_Eh_Intercept         2.81      0.20     2.44     3.22 1.00    10754    18642
# lnR_Th_Intercept       307.62      0.86   305.88   309.26 1.00     9660    16251

plot(conditional_effects(m, effects = "K:species", re_formula = NULL,
                         spaghetti = TRUE,
                         ndraws = 100),
     points = T)

# these are now constrained by the correlations shown in the summary above
# still, similar enough to the ones estimated by Barton et al. 2020
coef(m)$species
# , , sigma_lnGP_Intercept
#
#     Estimate Est.Error      Q2.5      Q97.5
# ac -1.479067 0.1302022 -1.720128 -1.2112969
# bn -1.548800 0.1269655 -1.784170 -1.2867338
# cr -1.312152 0.1606417 -1.604315 -0.9766778
# dt -1.538281 0.1485232 -1.811586 -1.2322382
# eh -1.283663 0.1863409 -1.620514 -0.8889912
# go -1.537129 0.1655022 -1.839467 -1.1881091
# gs -1.872677 0.1624271 -2.182666 -1.5495079
# mp -1.667057 0.1408724 -1.934333 -1.3792055
# ns -1.578068 0.1293562 -1.819232 -1.3081619
# ot -1.640900 0.1588238 -1.941997 -1.3179890
# pa -1.690182 0.1206781 -1.919294 -1.4450248
# pp -1.747915 0.1413926 -2.015976 -1.4625476
# pt -2.023856 0.1755523 -2.357209 -1.6710780
# rm -1.956203 0.1457468 -2.234024 -1.6646144
# sc -1.879593 0.1489905 -2.165487 -1.5809880
# st -1.338611 0.1283543 -1.575789 -1.0740168
# th -1.648318 0.1314652 -1.894858 -1.3803421
# tp -1.532545 0.1281972 -1.770601 -1.2676097
#
# , , lnGP_lnc_Intercept
#
#      Estimate Est.Error       Q2.5      Q97.5
# ac -2.9901519 0.1497863 -3.2858011 -2.6954004
# bn -2.2685457 0.1435086 -2.5508301 -1.9837889
# cr -1.3880239 0.1584193 -1.7022835 -1.0759095
# dt -1.0103560 0.1540090 -1.3122619 -0.7057400
# eh -2.6450922 0.1565448 -2.9521499 -2.3336936
# go -0.7337354 0.1515385 -1.0339945 -0.4362500
# gs -2.2089764 0.1467128 -2.4962875 -1.9162539
# mp -2.6409107 0.1297359 -2.8953019 -2.3841096
# ns -1.9300201 0.1465856 -2.2183801 -1.6407680
# ot -1.3964363 0.1508267 -1.6947028 -1.1008131
# pa -1.1528335 0.1424689 -1.4375893 -0.8773593
# pp -2.6775652 0.1480991 -2.9672793 -2.3829325
# pt -1.6933228 0.1392179 -1.9674185 -1.4191854
# rm -2.1907307 0.1395659 -2.4672441 -1.9153403
# sc  0.4532469 0.1440603  0.1621485  0.7284205
# st -2.7196564 0.1477791 -3.0110292 -2.4251610
# th -3.4124290 0.1469118 -3.7012415 -3.1215068
# tp -2.2433112 0.1411884 -2.5214844 -1.9644096
#
# , , lnGP_Ea_Intercept
#
#     Estimate  Est.Error      Q2.5     Q97.5
# ac 0.7859521 0.07029955 0.6585552 0.9327682
# bn 0.7441260 0.04921288 0.6487646 0.8456533
# cr 0.7781635 0.07211384 0.6488943 0.9357470
# dt 0.6502345 0.06010999 0.5269817 0.7589988
# eh 0.8571975 0.07832172 0.7208511 1.0203329
# go 0.8256666 0.07269173 0.7011408 0.9798190
# gs 0.7177597 0.04721916 0.6226059 0.8118895
# mp 0.7474594 0.05443627 0.6372719 0.8536143
# ns 0.7575576 0.05194132 0.6621138 0.8685450
# ot 0.6292937 0.07479719 0.4726120 0.7554038
# pa 0.6624611 0.05162172 0.5582224 0.7590842
# pp 0.6970216 0.04999577 0.5942104 0.7913996
# pt 0.7600798 0.04446233 0.6752126 0.8519664
# rm 0.7222712 0.04552660 0.6308266 0.8117730
# sc 0.7135767 0.05003189 0.6139791 0.8129605
# st 0.7057584 0.05206950 0.6004620 0.8073186
# th 0.7615515 0.05428187 0.6541472 0.8710891
# tp 0.7689124 0.04761678 0.6806627 0.8676145
#
# , , lnGP_Eh_Intercept
#
#    Estimate Est.Error     Q2.5     Q97.5
# ac 4.989973 1.0704433 2.902028  7.114872
# bn 5.512984 0.9939411 3.553995  7.473542
# cr 4.065752 1.0785976 1.962993  6.211292
# dt 7.882979 1.2074808 5.607917 10.343051
# eh 8.377540 1.4691056 5.674868 11.405338
# go 8.999668 1.3701995 6.323739 11.701066
# gs 6.170637 0.9600441 4.290689  8.057776
# mp 4.703304 0.9662155 2.860490  6.628543
# ns 6.755588 1.0160190 4.762651  8.759481
# ot 5.282520 1.1508367 3.044669  7.568302
# pa 4.410464 1.0338235 2.385785  6.448674
# pp 7.954075 1.0746492 5.810671 10.058541
# pt 7.903853 1.1041554 5.839127 10.140001
# rm 4.874504 0.9890159 2.907176  6.780054
# sc 6.337196 1.0663146 4.266565  8.462985
# st 4.757450 1.0495638 2.699707  6.829401
# th 4.152899 1.0105326 2.192397  6.153421
# tp 6.494729 1.0083317 4.552949  8.506801
#
# , , lnGP_Th_Intercept
#
#    Estimate Est.Error     Q2.5    Q97.5
# ac 304.5863 0.6503875 303.3059 305.8703
# bn 306.7392 0.6089027 305.5009 307.8967
# cr 303.5926 0.9817446 301.6791 305.5504
# dt 312.5328 0.5736194 311.3352 313.6000
# eh 302.5591 0.5159924 301.5206 303.5740
# go 303.3991 0.4785301 302.4288 304.3349
# gs 309.4629 0.4833987 308.4768 310.3894
# mp 301.4087 0.6410589 300.1171 302.6511
# ns 308.1047 0.5625457 306.9636 309.1929
# ot 308.6247 0.7503692 307.0349 309.9838
# pa 312.9390 0.6900671 311.5438 314.2644
# pp 311.6287 0.5081337 310.5618 312.5719
# pt 307.0320 0.4538962 306.1037 307.9092
# rm 306.7690 0.5991875 305.5755 307.9365
# sc 305.7332 0.5121852 304.7153 306.7419
# st 311.0057 0.8212450 309.3021 312.5600
# th 302.3613 0.7049965 300.9248 303.6987
# tp 306.1209 0.5259646 305.0712 307.1434
#
# , , lnR_lnc_Intercept
#
#     Estimate Est.Error      Q2.5      Q97.5
# ac -3.380374 0.2040752 -3.781144 -2.9783173
# bn -3.623903 0.2015233 -4.016844 -3.2287340
# cr -2.034187 0.2017001 -2.439430 -1.6458292
# dt -2.878154 0.2054243 -3.282485 -2.4727465
# eh -3.912466 0.2205718 -4.346722 -3.4765835
# go -2.252680 0.2154892 -2.681232 -1.8308097
# gs -3.503602 0.2022988 -3.898177 -3.1047793
# mp -4.172479 0.1881945 -4.539220 -3.7985827
# ns -3.500001 0.2036297 -3.899606 -3.0988365
# ot -2.622842 0.2118836 -3.036987 -2.2024475
# pa -2.170394 0.2005320 -2.569415 -1.7793522
# pp -4.653906 0.2057392 -5.046231 -4.2391559
# pt -3.004279 0.1998694 -3.396629 -2.6145107
# rm -3.774306 0.1953237 -4.155616 -3.3886643
# sc -1.016733 0.2003786 -1.414073 -0.6274295
# st -4.152749 0.2072806 -4.558402 -3.7454899
# th -4.380548 0.2044472 -4.781782 -3.9754433
# tp -3.816393 0.1952546 -4.200921 -3.4304021
#
# , , lnR_Ea_Intercept
#
#     Estimate  Est.Error      Q2.5    Q97.5
# ac 0.8287264 0.08552852 0.6659626 1.006954
# bn 1.1865211 0.09453568 1.0050200 1.374932
# cr 0.9882956 0.08833967 0.8151850 1.164136
# dt 0.9447613 0.09230208 0.7658313 1.128729
# eh 1.1655009 0.13242157 0.9155679 1.436267
# go 1.2268286 0.13340978 0.9778638 1.501522
# gs 0.9816842 0.08917660 0.8064964 1.158379
# mp 1.1551771 0.09013624 0.9844334 1.337841
# ns 1.2258521 0.10177359 1.0299262 1.426712
# ot 1.2321518 0.13745396 0.9858214 1.522409
# pa 0.8770103 0.08162285 0.7203504 1.041938
# pp 1.1309491 0.09298722 0.9533822 1.317018
# pt 1.0279875 0.09132741 0.8460084 1.206028
# rm 0.9062397 0.08774704 0.7356569 1.079132
# sc 1.0909249 0.07865678 0.9372469 1.248658
# st 0.9001866 0.08848090 0.7279784 1.073835
# th 1.0502118 0.09445107 0.8686162 1.240352
# tp 0.9562593 0.08242449 0.7935920 1.114398
#
# , , lnR_Eh_Intercept
#
#    Estimate Est.Error     Q2.5    Q97.5
# ac 3.416085 0.4907463 2.515126 4.434453
# bn 2.219236 0.3244598 1.587508 2.856960
# cr 2.678472 0.4103284 1.908630 3.542158
# dt 3.559439 0.5764247 2.556860 4.802309
# eh 3.084979 0.4360896 2.277334 3.997430
# go 2.458068 0.3939889 1.690659 3.246349
# gs 3.487166 0.3828436 2.763297 4.251474
# mp 2.346560 0.3000501 1.766866 2.941039
# ns 3.188221 0.3762647 2.505387 3.956306
# ot 2.488973 0.4312560 1.668077 3.365165
# pa 2.499054 0.3336629 1.853621 3.160242
# pp 3.565316 0.4407756 2.729513 4.449366
# pt 2.742321 0.2911117 2.172308 3.320604
# rm 2.761949 0.3983651 2.000041 3.580086
# sc 2.337050 0.3287876 1.699900 2.984223
# st 2.335905 0.3410449 1.671778 3.007236
# th 2.249021 0.3684312 1.544758 2.980457
# tp 3.018466 0.3575764 2.363833 3.767784
#
# , , lnR_Th_Intercept
#
#    Estimate Est.Error     Q2.5    Q97.5
# ac 314.3784 0.9241742 312.2636 315.8882
# bn 304.9968 1.3349054 302.3911 307.6570
# cr 307.9266 1.1631672 305.4350 310.0442
# dt 312.2874 1.0076979 310.0024 313.9596
# eh 304.7755 1.2023576 302.2712 307.0292
# go 304.3873 1.7388744 300.8870 307.6710
# gs 310.4030 0.7906299 308.7479 311.8600
# mp 302.4574 1.1615571 300.0948 304.6873
# ns 307.0279 0.8475724 305.3406 308.6950
# ot 307.5616 2.0271757 303.3311 311.2155
# pa 311.4384 1.1197056 309.1269 313.5412
# pp 309.9061 0.8518736 308.0881 311.4595
# pt 307.4227 0.9219269 305.5719 309.1991
# rm 307.9091 1.2115493 305.2625 310.0083
# sc 307.2129 0.9990000 305.1653 309.1275
# st 306.7358 1.3049794 304.0847 309.2172
# th 304.3840 1.6711298 301.0327 307.6103
# tp 306.2740 0.8645624 304.4686 307.8656
#
# , , sigma_lnR_Intercept
#
#      Estimate Est.Error      Q2.5      Q97.5
# ac -1.9514992 0.1527938 -2.238150 -1.6415736
# bn -1.5561297 0.1330920 -1.802474 -1.2799779
# cr -1.6993789 0.1799736 -2.046794 -1.3458686
# dt -1.4833280 0.1473643 -1.761137 -1.1813969
# eh -0.8503846 0.1365698 -1.102290 -0.5652134
# go -1.4502000 0.1511049 -1.734623 -1.1408274
# gs -1.4457877 0.1373693 -1.702172 -1.1612835
# mp -1.3927312 0.1319977 -1.639966 -1.1227445
# ns -1.4969748 0.1473625 -1.772741 -1.1974445
# ot -1.3905048 0.1388513 -1.650056 -1.1039810
# pa -1.6974937 0.1288784 -1.940197 -1.4340930
# pp -1.5716700 0.1317168 -1.818502 -1.3037742
# pt -1.3449835 0.1164365 -1.563174 -1.1063400
# rm -1.5913293 0.1252757 -1.827356 -1.3363466
# sc -1.9089497 0.1419831 -2.173401 -1.6211589
# st -1.3394333 0.1134797 -1.550051 -1.1066883
# th -1.6166133 0.1383013 -1.877049 -1.3349068
# tp -1.4980610 0.1306811 -1.745085 -1.2292820

plot(conditional_effects(m,
                         resp = "lnGP",
                         effects = "K:species",
                         prob = 0,
                         re_formula = NULL),
     points = T)

